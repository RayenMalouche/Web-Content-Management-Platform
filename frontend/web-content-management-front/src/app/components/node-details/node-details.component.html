<form class="property-groups-container" [formGroup]="form" *ngIf="(selectedNodeFinal$ | async) as selNode; else noSelectedNode">
  <div class="property-group">
    <div class="property-group-title">
      General Properties
      <i class="fas fa-chevron-down"></i>
    </div>
    <div class="property-content">
      <div class="property-item">
        <div class="property-label">Name</div>
        <input type="text" name="nodeName" id="nodeName" placeholder="Enter Name" class="property-value" formControlName="name">
      </div>

      <div class="property-item">
        <div class="property-label">Type</div>
        <input type="text" name="nodeType" id="nodeType" placeholder="Node Type" class="property-value" formControlName="ntype" readonly>
      </div>

      <div class="property-item" *ngIf="selNode.type !== 'widget'">
        <div class="property-label">Number of Children</div>
        <input type="number" name="nodeChildrenCount" id="nodeChildrenCount" placeholder="Enter Name" class="property-value" formControlName="childrenCount" readonly>
      </div>

      <div class="property-item" *ngIf="selNode.type === 'widget'">
        <div class="property-label">Widget ID</div>
        <select class="dropdown-select" id="widgetId" formControlName="widgetId">
          <option [value]="wId" *ngFor="let wId of WIDGET_ID_LIST">{{ wId }}</option>
        </select>
      </div>

      <div class="property-item">
        <div class="property-label">Description</div>
        <input type="text" name="description" id="description" placeholder="Description" class="property-value" formControlName="description">
      </div>
    </div>
  </div>

  <div class="property-group">
    <div class="property-group-title">
      Dimensions
      <i class="fas fa-chevron-down"></i>
    </div>
    <div class="property-content">
      <div class="dimension-inputs">
        <div class="property-item">
          <div class="property-label">Width</div>
          <input type="text" name="width" id="width" placeholder="Enter Width" class="property-value" formControlName="width">
        </div>

        <div class="property-item">
          <div class="property-label">Height</div>
          <input type="text" name="height" id="height" placeholder="Enter Height" class="property-value" formControlName="height">
        </div>
      </div>
    </div>
  </div>

  <div class="property-group">
    <div class="property-group-title">
      Appearance
      <i class="fas fa-chevron-down"></i>
    </div>
    <div class="property-content">
      <div class="property-item">
        <div class="property-label">Background Color</div>
        <div class="color-input-group">
          <input type="color" name="backgroundColor" id="backgroundColor" formControlName="backgroundColor">
          <input type="text" class="property-value" [value]="form.get('backgroundColor')?.value" readonly>
        </div>
      </div>

      <div class="property-item">
        <div class="property-label">Border Color</div>
        <div class="color-input-group">
          <input type="color" name="borderColor" id="borderColor" formControlName="borderColor">
          <input type="text" class="property-value" [value]="form.get('borderColor')?.value" readonly>
        </div>
      </div>
    </div>
  </div>

  <div class="property-item" style="margin-top: 20px;">
    <button class="property-value" style="background-color: #0d6efd; color: white; cursor: pointer;" (click)="onSave(selNode)">Save</button>
  </div>
</form>

<ng-template #noSelectedNode>
  <div class="property-groups-container">
    <div class="property-item" style="text-align: center; color: #f8f9fa;">
      No node selected
    </div>
  </div>
</ng-template>
